好的，我把它改成**H5 Demo 的“Cursor可直接参照生成版 PRD”**——三大模块（**对话 / 发现 / 我的**）清晰落到**路由、页面、状态、数据对象、接口契约、文案、异常与验收**。不写代码，但足够让你在 Cursor 用本 PRD 直接生成与落地。

---

# LoneIn · H5 Demo PRD（Cursor 生成导向 / 无图）

## 0. 产品定位（MVP 范围）

* **愿景**：让孤独不再寂寞；把 **\[情绪]→\[作品]**，再把 **\[作品]→\[关系]**，实现“被看见 / 被续写 / 被共鸣”。
* **核心能力**：AI 像循循善诱的伙伴，通过深度对话引导情绪输出，并在合适时机转化为 **诗歌/歌曲/图像/短片**（Demo 以**诗词卡片、图片**为主，音频/视频保留入口与占位）。&#x20;
* **关系沉淀**：作品构成“第二朋友圈 / 情绪档案”，可分享、投递「流光瓶」、在社区获得共鸣。

---

## 1. 信息架构 & 路由

* **/chat（对话）**：情绪对话 → 合适时机触发 → 形态选择 → 生成作品 → 换一种表达
* **/discover（发现）**：推荐 / 关注 / 共鸣墙 / 流光瓶（轻量版 Tab）
* **/me（我的）**：作品流（时间序）+ 作品详情（共鸣/评论/分享/再生成/换形态）

> 目标是跑通 H5 **最小闭环**：对话 → 生成 → 保存/分享 → 发现。

---

## 2. 核心流程（对话 → 生成 → 可换形态）

### 2.1 阶段化引导（Agent 行为）

A. **开场与安全区**：开放式提问“今天发生了什么/你在意什么”。
B. **具象化**：从“感受词”走向“具体人事物与画面”。
C. **深描与意义**：引导“这件事对你意味着什么/最想被理解的部分”。
D. **创作意向确认**：命中触发条件时，轻量建议 1–2 个形态（尊重继续聊天）。
E. **生成与回看**：产出作品卡 → 保存/分享/再生成/换形态。
（与“AI 深度对话→化作诗/歌/图/短片”的定位一致。）

### 2.2 触发时机（无代码规则）

* **内容深度**：出现人物/场景/因果/意象；
* **情绪强度**：孤独/思念/悲伤/喜悦等强烈词；
* **对话轮次**：≥ N（建议 6–8）；
* **意向表达**：用户提到“想留点纪念/想做一首歌/看成一张图”；
* **语境信号**：纪念日/夜深/独处等词。
  **出现形式**：对话流上方/输入框上方的「建议生成」**气泡**（不遮挡输入）。

### 2.3 形态匹配（优先级）

* **诗词卡片**：抽象情绪、短句、需快速定稿；
* **图片（画作）**：意象强、画面感足；
* **音频**：情绪起伏明显、想被“听见”；
* **视频**：叙事完整、多个强意象。
  （与“情绪折射为诗歌/音乐/图像/短片”的理念一致。）

### 2.4 换一种表达

* 作品卡提供 **「换形态」**：沿用同一内容摘要与情绪标签，仅切换渲染方式。
* **失败回退**：统一回退为**诗词卡片**（最稳态产物），保证“被看见”的最低可用表达。
* 生成后可 **分享 / 投递流光瓶 / 参与共鸣互动**，把作品沉淀为关系。

---

## 3. 页面规格（含状态/文案/空态/异常）

### 3.1 /chat 对话页

**主要区块**

* 对话流（用户/AI 消息气泡、时间戳）
* 输入区（文本；语音入口占位）
* 建议生成气泡（命中触发时显示：系统首选形态 + 展开更多）
* 作品卡（标题、情绪标签、说明；操作：保存到我的 / 分享 / 换形态）

**关键交互**

* 触发气泡出现频率：**每 10 轮 ≤ 2 次**（可配置）；
* 用户拒绝后，**再提示间隔 ≥ 3 轮**；
* 生成过程显示「正在为你把这段心情化成作品…」，可取消/重试；
* 成功后插入作品卡；失败 → 弹 Toast「已为你保留文字版诗卡」。

**文案样例**

* 提示：`要把这段心情留成一张诗卡/一幅画吗？`
* 成功：`已为你保留下来。`
* 失败回退：`生成超时，已替你保存为诗卡。`

**空态**

* 首次进入：`和我聊聊，今天发生了什么？`

**验收要点**

* 建议不打扰、回退稳定、换形态流程通畅。

---

### 3.2 /discover 发现页（轻量多 Tab）

Tabs：**推荐 / 关注 / 共鸣墙 / 流光瓶**

* **推荐**：同类（相似情绪/题材）、共时（同一时间段）、主页后扩展推荐基线。
* **关注**：所关注对象的最新作品流。
* **共鸣墙**：按话题/情绪标签聚合浏览，鼓励“意外相遇”。
* **流光瓶**：投递/拾取情绪作品，制造“同频邂逅”。

**空态文案**

* 推荐：`去和我聊聊，作品会在这里遇见同频的人。`
* 关注：`还没有关注的人，去发现页逛逛吧。`
* 共鸣墙：`挑一个你在意的话题试试。`
* 流光瓶：`扔出一只瓶子，看看谁会拾起。`

---

### 3.3 /me 我的页

* **作品流**：按时间排序，展示诗/图（音频/视频为占位卡）+ 情绪标签 + 可见性
* **作品详情**：共鸣/评论/分享/删除/再生成/换形态（同一语义内核）
* **资料**：昵称/签名/头像与隐私设置（公开/私密）
  （“第二朋友圈 / 情绪档案”的沉淀位。）

---

## 4. 数据对象（Demo 级）

**User**：id, nickname, avatar, bio, created\_at
**Session**：id, user\_id, created\_at, status
**Message**：id, session\_id, role(user/ai), content, created\_at
**EmotionEval**：id, session\_id, depth\_score, intensity, labels\[], trigger\_signals\[]
**Work**：id, user\_id, session\_id, source\_message\_id, modality(poem/image/audio/video), title, desc, emotion\_labels\[], visibility(public/private), created\_at
**WorkAsset**：id, work\_id, url, cover\_url, duration, meta{}
**Interaction**：id, work\_id, user\_id, type(resonate|comment|share), content, created\_at
**Bottle**：id, work\_id, topic\_tags\[], status(thrown|picked), matched\_user\_id, created\_at
（与“作品沉淀成关系 / 分享 / 流光瓶 / 共鸣场域”相契合。）

---

## 5. 接口契约（不含代码，仅供 Cursor 生成）

> 说明：可用 REST 规范或同名本地 Mock，先跑通前端闭环。

### 5.1 对话 & 生成

* **POST /chat/send**
  Req：{ session\_id?, text?, audio\_url? }
  Res：{ message\_id, session\_id }

* **GET /chat/\:session\_id/stream**（SSE/WS 可选）
  Res：{ message\_id, reply\_text, emotion\_eval:{depth,intensity,labels\[]} }

* **POST /generate/trigger**
  Req：{ session\_id, message\_id, modality? } // 若不传，由服务端按规则选
  Res：{ work\_id, modality, status(pending|ready|failed) }

* **POST /generate/regenerate**
  Req：{ work\_id, target\_modality }
  Res：{ new\_work\_id, modality, status }

### 5.2 发现

* **GET /discover/feed**
  Query：{ tab: recommend|follow|wall|bottle, page }
  Res：items\[ { work\_id, user, modality, cover, emotion\_labels, created\_at } ]

* **POST /bottle/throw**：{ work\_id, topic\_tags\[] } → 200

* **POST /bottle/pick**：{} → { work\_id | null }

### 5.3 我的 & 互动

* **GET /me/works**：{ page } → works\[]
* **GET /works/\:id** → work detail + assets + interactions
* **POST /works/\:id/share** / **POST /works/\:id/delete**
* **POST /interactions**：{ work\_id, type, content? } → 200

---

## 6. 推荐策略（MVP 基线）

* **同类推荐**：相似情绪/题材的作品；
* **共时推荐**：同一时间段心境相近作品；
* **主页后推荐**：浏览某人主页后，延展相近作品。

---

## 7. 指标与验收

* **闭环跑通率**：首次对话→首个作品保存 ≥ 70%
* **触发建议 CTR**：≥ 20%（灰度参数可调）
* **生成成功率**：诗卡 ≥ 98%；图片 ≥ 90%
* **换形态使用率**：≥ 15%
* **发现页点击率**：≥ 30%
* **稳定性**：失败回退必达诗卡；错误可重试

---

## 8. 文案与提示（可直接贴入）

* 建议生成：`要把这段心情留成一张诗卡/一幅画吗？`
* 生成中：`正在为你把这段心情化成作品…`
* 成功：`已为你保留下来。`
* 失败回退：`生成超时，已替你保存为诗卡。`
* 流光瓶：`扔出一只瓶子，看看谁会拾起。`

---

## 9. 隐私与合规（Demo）

* 用户可删除会话与作品；分享默认不含个人敏感信息。
* 社区治理：举报/屏蔽/关键词审核（轻量版本）。

---

## 10. 版本范围

* **H5 Demo（当前）**：对话闭环 + 诗卡/图片生成 + 发现轻量 + 我的沉淀
* **后续**：音频/视频生成、推荐强化、流光瓶匹配策略升级、更多社交互动

---

如果你需要，我可以把本 PRD再**转换成 `TODO.md` / `ISSUES.md` 的任务清单格式**（逐条可勾选、带验收标准与接口引用），方便你直接在 Cursor 里创建文件并开干。
